<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề Thi Công Nghệ Lớp 4 - Đề Số 1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; }
        .question-box { background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .option-label { display: block; margin-bottom: 8px; cursor: pointer; }
        .option-label:hover { background-color: #e5e7eb; border-radius: 4px; padding-left: 5px; transition: 0.2s; }
    </style>
</head>
<body class="bg-purple-50 py-10">

    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-lg overflow-hidden">
        <div class="bg-purple-600 p-6 text-white text-center">
            <h1 class="text-2xl font-bold uppercase">BÀI KIỂM TRA ĐỊNH KỲ CUỐI HỌC KỲ I</h1>
            <p class="text-lg mt-2">Môn thi: CÔNG NGHỆ – Lớp 4 (Đề 1)</p>
            <p class="text-sm italic">(Thời gian làm bài: 35 phút)</p>
        </div>

        <div class="p-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 border-b pb-6">
                <div>
                    <label class="block text-gray-700 font-bold mb-2">Họ và tên thí sinh:</label>
                    <input type="text" id="hoTen" class="w-full border-2 border-purple-200 p-3 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Nhập họ tên...">
                </div>
                <div>
                    <label class="block text-gray-700 font-bold mb-2">Lớp:</label>
                    <input type="text" id="lop" class="w-full border-2 border-purple-200 p-3 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ví dụ: 4A">
                </div>
            </div>

            <h2 class="text-xl font-bold text-purple-800 mb-4 border-l-4 border-purple-600 pl-3">I. PHẦN TRẮC NGHIỆM</h2>
            <p class="italic text-gray-600 mb-4">Khoanh tròn vào chữ cái trước câu trả lời đúng.</p>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 1 (1 điểm): <span class="font-normal">Loài hoa nào sau đây thường nở vào dịp Tết Nguyên đán ở miền Bắc nước ta, tượng trưng cho sự may mắn?</span></p>
                <label class="option-label"><input type="radio" name="cau1" value="A"> A. Hoa phượng.</label>
                <label class="option-label"><input type="radio" name="cau1" value="B"> B. Hoa sen.</label>
                <label class="option-label"><input type="radio" name="cau1" value="C"> C. Hoa đào.</label>
                <label class="option-label"><input type="radio" name="cau1" value="D"> D. Hoa bằng lăng.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 2 (1 điểm): <span class="font-normal">Đâu là đặc điểm nổi bật của chậu nhựa trồng cây?</span></p>
                <label class="option-label"><input type="radio" name="cau2" value="A"> A. Nặng, khó di chuyển.</label>
                <label class="option-label"><input type="radio" name="cau2" value="B"> B. Nhẹ, mềm, khó vỡ, nhiều màu sắc.</label>
                <label class="option-label"><input type="radio" name="cau2" value="C"> C. Cứng, dễ vỡ khi va chạm.</label>
                <label class="option-label"><input type="radio" name="cau2" value="D"> D. Thấm nước tốt qua thành chậu.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 3 (1 điểm): <span class="font-normal">Để tưới nước cho các chậu hoa nhỏ hoặc gieo hạt mà không làm xói đất, em nên dùng dụng cụ nào?</span></p>
                <label class="option-label"><input type="radio" name="cau3" value="A"> A. Gáo múc nước.</label>
                <label class="option-label"><input type="radio" name="cau3" value="B"> B. Vòi phun nước áp lực mạnh.</label>
                <label class="option-label"><input type="radio" name="cau3" value="C"> C. Xô nước lớn.</label>
                <label class="option-label"><input type="radio" name="cau3" value="D"> D. Bình tưới vòi sen hoặc bình xịt.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 4 (1 điểm): <span class="font-normal">Khi chuẩn bị chậu trồng cây, vì sao người ta thường rải một lớp sỏi hoặc đá dăm nhỏ ở dưới đáy chậu?</span></p>
                <label class="option-label"><input type="radio" name="cau4" value="A"> A. Để chậu nặng hơn, không bị gió thổi bay.</label>
                <label class="option-label"><input type="radio" name="cau4" value="B"> B. Giúp thoát nước tốt, ngăn không cho lỗ thoát nước bị tắc.</label>
                <label class="option-label"><input type="radio" name="cau4" value="C"> C. Để tiết kiệm đất trồng.</label>
                <label class="option-label"><input type="radio" name="cau4" value="D"> D. Để làm đẹp cho đáy chậu.</label>
            </div>

             <div class="question-box">
                <p class="font-bold mb-2">Câu 5 (1 điểm): <span class="font-normal">Giá thể dùng để trồng hoa, cây cảnh trong chậu thường là hỗn hợp của các thành phần nào?</span></p>
                <label class="option-label"><input type="radio" name="cau5" value="A"> A. Chỉ có đất sét và nước.</label>
                <label class="option-label"><input type="radio" name="cau5" value="B"> B. Đất, xơ dừa, trấu hun, phân bón.</label>
                <label class="option-label"><input type="radio" name="cau5" value="C"> C. Đá sỏi và cát biển.</label>
                <label class="option-label"><input type="radio" name="cau5" value="D"> D. Cát và nước.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 6 (1 điểm): <span class="font-normal">Hành động nào sau đây là SAI khi chăm sóc hoa, cây cảnh trong chậu?</span></p>
                <label class="option-label"><input type="radio" name="cau6" value="A"> A. Thường xuyên nhặt bỏ lá vàng, lá sâu.</label>
                <label class="option-label"><input type="radio" name="cau6" value="B"> B. Đặt chậu cây ở nơi hoàn toàn không có ánh sáng mặt trời trong thời gian dài.</label>
                <label class="option-label"><input type="radio" name="cau6" value="C"> C. Lau bụi trên lá cây (đối với các loại cây lá to, bóng).</label>
                <label class="option-label"><input type="radio" name="cau6" value="D"> D. Tưới nước vừa đủ ẩm cho đất.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 7 (0,5 điểm): <span class="font-normal">Cây Kim tiền và cây Lưỡi hổ được xếp vào nhóm nào?</span></p>
                <label class="option-label"><input type="radio" name="cau7" value="A"> A. Nhóm cây lấy gỗ.</label>
                <label class="option-label"><input type="radio" name="cau7" value="B"> B. Nhóm cây ăn quả.</label>
                <label class="option-label"><input type="radio" name="cau7" value="C"> C. Nhóm cây cảnh (chơi lá/thân).</label>
                <label class="option-label"><input type="radio" name="cau7" value="D"> D. Nhóm cây rau màu.</label>
            </div>

            <div class="question-box">
                <p class="font-bold mb-2">Câu 8: <span class="font-normal">Khi thấy chậu cây cảnh đặt trong phòng thiếu ánh sáng bị vàng lá, em nên làm gì?</span></p>
                <label class="option-label"><input type="radio" name="cau8" value="A"> A. Tưới thật nhiều nước cho cây.</label>
                <label class="option-label"><input type="radio" name="cau8" value="B"> B. Bón thêm nhiều phân đạm.</label>
                <label class="option-label"><input type="radio" name="cau8" value="C"> C. Mang cây ra vị trí có ánh sáng phù hợp và chăm sóc.</label>
                <label class="option-label"><input type="radio" name="cau8" value="D"> D. Cắt bỏ hết lá và để nguyên vị trí cũ.</label>
            </div>

            <h2 class="text-xl font-bold text-purple-800 mb-4 border-l-4 border-purple-600 pl-3 mt-8">II. PHẦN TỰ LUẬN</h2>
            
            <div class="mb-6">
                <p class="font-bold mb-2">Câu 9 (2 điểm): Em hãy kể tên 3 loại dụng cụ trồng hoa, cây cảnh mà em biết.</p>
                <textarea id="cau9_tuluan" rows="3" class="w-full border p-3 rounded bg-purple-50 focus:bg-white" placeholder="Ví dụ: Bình tưới, găng tay, xẻng nhỏ..."></textarea>
            </div>

            <div class="mb-6">
                <p class="font-bold mb-2">Câu 10 (2 điểm): Em hãy viết tên 5 loại hoa được trồng trong trường và ở gần nhà em.</p>
                <textarea id="cau10_tuluan" rows="4" class="w-full border p-3 rounded bg-purple-50 focus:bg-white" placeholder="Viết câu trả lời của em vào đây..."></textarea>
            </div>

            <div class="text-center mt-10">
                <button onclick="nopBai()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-10 rounded-full shadow-lg transform transition hover:scale-105">
                    NỘP BÀI THI
                </button>
                <p class="text-sm text-gray-500 mt-2 italic">Hãy kiểm tra kỹ bài làm trước khi ấn nút nộp con nhé!</p>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- CẤU HÌNH FIREBASE ---
        // Bạn hãy dán API Key của bạn vào đây (giống như bên môn Toán)
        const firebaseConfig = {
            apiKey: "THAY_API_KEY_CUA_BAN_VAO_DAY", 
            authDomain: "edumath-lop4.firebaseapp.com",
            projectId: "edumath-lop4",
            storageBucket: "edumath-lop4.appspot.com",
            messagingSenderId: "...",
            appId: "..."
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- THÔNG TIN ĐỀ THI ---
        const MON_HOC = "Công Nghệ";
        const MA_DE = "Đề 01"; // Giữ là Đề 1 vì đây là file đầu tiên của môn này

        window.nopBai = async function() {
            const btn = document.querySelector('button');
            btn.disabled = true;
            btn.innerText = "Đang nộp...";

            const hoTen = document.getElementById('hoTen').value.trim();
            const lop = document.getElementById('lop').value.trim();

            if (!hoTen || !lop) {
                alert("Con chưa điền Tên hoặc Lớp!");
                btn.disabled = false;
                btn.innerText = "NỘP BÀI THI";
                return;
            }

            // --- CHẤM ĐIỂM TRẮC NGHIỆM TỰ ĐỘNG ---
            let diemTN = 0;

            // Câu 1: C. Hoa đào (1đ)
            if(document.querySelector('input[name="cau1"]:checked')?.value === "C") diemTN += 1;
            
            // Câu 2: B. Nhẹ, mềm... (1đ)
            if(document.querySelector('input[name="cau2"]:checked')?.value === "B") diemTN += 1;

            // Câu 3: D. Bình tưới vòi sen (1đ)
            if(document.querySelector('input[name="cau3"]:checked')?.value === "D") diemTN += 1;

            // Câu 4: B. Giúp thoát nước (1đ)
            if(document.querySelector('input[name="cau4"]:checked')?.value === "B") diemTN += 1;

            // Câu 5: B. Đất, xơ dừa... (1đ)
            if(document.querySelector('input[name="cau5"]:checked')?.value === "B") diemTN += 1;

            // Câu 6: B. Đặt nơi không có ánh sáng (1đ)
            if(document.querySelector('input[name="cau6"]:checked')?.value === "B") diemTN += 1;

            // Câu 7: C. Nhóm cây cảnh (0.5đ)
            if(document.querySelector('input[name="cau7"]:checked')?.value === "C") diemTN += 0.5;

            // Câu 8: C. Mang cây ra sáng (0.5đ - Giả định điểm vì đề không ghi)
            if(document.querySelector('input[name="cau8"]:checked')?.value === "C") diemTN += 0.5;

            // --- LẤY NỘI DUNG TỰ LUẬN ---
            const baiTuLuan = `
                Câu 9: ${document.getElementById('cau9_tuluan').value}
                Câu 10: ${document.getElementById('cau10_tuluan').value}
            `;

            // --- GỬI LÊN FIREBASE ---
            try {
                await addDoc(collection(db, "Baikiemtracuoiki"), {
                    ho_ten: hoTen,
                    lop: lop,
                    mon_hoc: MON_HOC,
                    ma_de: MA_DE,
                    diem_trac_nghiem: diemTN,
                    diem_tu_luan: 0, // Giáo viên chấm sau
                    bai_tu_luan: baiTuLuan,
                    thoi_gian_nop: new Date().toISOString()
                });

                alert(`Nộp bài thành công!\nĐiểm trắc nghiệm tạm tính: ${diemTN} điểm.`);
                btn.style.display = 'none'; // Ẩn nút nộp
            } catch (e) {
                console.error(e);
                alert("Lỗi đường truyền! Con hãy báo ngay cho cô giáo.");
                btn.disabled = false;
                btn.innerText = "NỘP BÀI THI";
            }
        }
    </script>
</body>
</html>
