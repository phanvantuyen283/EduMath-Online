<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thi Tiáº¿ng Viá»‡t - Äá» 2 (Káº¿t ná»‘i tri thá»©c)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; }
        input[type="radio"] { width: 1.2rem; height: 1.2rem; margin-top: 0.15rem; flex-shrink: 0; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        /* Style hiá»ƒn thá»‹ lá»i giáº£i */
        .explanation { display: none; margin-top: 10px; padding: 10px; background-color: #FFF7ED; border: 1px dashed #F97316; border-radius: 8px; color: #9A3412; font-size: 0.9rem; line-height: 1.5; }
        .correct-answer { background-color: #DCFCE7 !important; border-color: #22C55E !important; } 
        .wrong-answer { background-color: #FEE2E2 !important; border-color: #EF4444 !important; }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col overflow-hidden">

    <header class="flex-none bg-green-600 text-white p-2 px-4 shadow z-50 flex justify-between items-center">
        <h1 class="font-bold text-lg uppercase truncate">Tiáº¿ng Viá»‡t 4 - Äá» 2</h1>
        <div class="bg-white text-red-600 px-3 py-1 rounded-full font-black text-lg border-2 border-yellow-400 shadow">
            â±ï¸ <span id="dongHo">35:00</span>
        </div>
    </header>

    <div class="flex-none bg-green-100 p-2 shadow-sm border-b border-green-300 z-40" id="info-bar">
        <div class="max-w-4xl mx-auto grid grid-cols-12 gap-2 items-center">
            <div class="col-span-8 flex items-center gap-2">
                <label class="text-gray-800 font-bold text-xs whitespace-nowrap">Há» tÃªn:</label>
                <input type="text" id="hoTen" class="w-full border border-green-400 p-1.5 rounded focus:border-green-600 font-bold text-sm text-green-800 bg-white" placeholder="Nháº­p tÃªn con...">
            </div>
            <div class="col-span-4 flex items-center gap-2">
                <label class="text-gray-800 font-bold text-xs whitespace-nowrap">Lá»›p:</label>
                <input type="text" id="lop" class="w-full border border-green-400 p-1.5 rounded focus:border-green-600 font-bold text-center text-sm text-green-800 bg-white" placeholder="4A">
            </div>
        </div>
    </div>

    <div class="flex-1 flex flex-col min-h-0 relative">

        <div class="h-[50%] bg-white border-b-4 border-green-300 overflow-y-auto p-4 shadow-sm relative scroll-smooth">
            <div class="sticky top-0 bg-white/95 backdrop-blur py-1 border-b mb-2 z-10 flex justify-between items-center">
                <span class="text-[10px] font-bold bg-green-100 text-green-800 px-2 py-0.5 rounded">ğŸ“– VÄ‚N Báº¢N Äá»ŒC</span>
                <span class="text-[10px] text-gray-400 italic">Vuá»‘t Ä‘á»ƒ Ä‘á»c â¬‡ï¸</span>
            </div>
            
            <h2 class="text-xl font-black text-green-800 text-center mb-3 uppercase">TIáº¾NG HÃT BUá»”I Sá»šM MAI</h2>
            <div class="text-gray-800 text-base leading-relaxed text-justify space-y-3 pb-4">
                <p>BÃªn bÃ¬a rá»«ng cÃ³ má»™t bÃ´ng hoa láº¡, nÄƒm cÃ¡nh má»‹n nhÆ° nhung. BÃ´ng hoa toáº£ hÆ°Æ¡ng thÆ¡m ngÃ¡t. Quanh nÃ³, tháº¥p thoÃ¡ng nhá»¯ng cÃ¡nh bÆ°á»›m dáº­p dá»n.</p>
                <p>Máº·t Trá»i má»‰m cÆ°á»i vá»›i hoa. Tháº¿ lÃ  bÃ´ng hoa cáº¥t tiáº¿ng hÃ¡t. NÃ³ hÃ¡t mÃ£i, hÃ¡t mÃ£i. Cuá»‘i cÃ¹ng, nÃ³ há»i giÃ³ xem cÃ³ thÃ­ch bÃ i hÃ¡t Ä‘Ã³ khÃ´ng.</p>
                <p>GiÃ³ ngáº¡c nhiÃªn:<br>- Æ , chÃ­nh tÃ´i hÃ¡t Ä‘áº¥y chá»©? TÃ´i Ä‘Ã£ lÃ m nhá»¯ng cÃ¡nh hoa cá»§a báº¡n Ä‘ung Ä‘Æ°a, táº¡o thÃ nh tiáº¿ng lao xao nÃªn báº¡n cá»© tÆ°á»Ÿng mÃ¬nh hÃ¡t.</p>
                <p>Hoa láº¡i há»i sÆ°Æ¡ng. Nhá»¯ng háº¡t sÆ°Æ¡ng long lanh tráº£ lá»i:<br>- Báº¡n nháº§m rá»“i! ÄÃ³ chÃ­nh lÃ  tiáº¿ng ngÃ¢n nga thÃ¡nh thÃ³t cá»§a chÃºng tÃ´i.</p>
                <p>Tranh cÃ£i mÃ£i, cháº³ng ai chá»‹u ai. Hoa, giÃ³ vÃ  sÆ°Æ¡ng quyáº¿t Ä‘á»‹nh há»i bÃ¡c gÃ¡c rá»«ng.</p>
                <p>BÃ¡c gÃ¡c rá»«ng Ã´n tá»“n giáº£i thÃ­ch:<br>- Má»—i buá»•i sá»›m mai, khi Máº·t Trá»i báº¯t Ä‘áº§u sÆ°á»Ÿi áº¥m váº¡n váº­t, muÃ´n loÃ i Ä‘á»u hÃ¢n hoan hÃ¡t ca. NhÆ°ng má»—i loÃ i cÃ³ tiáº¿ng hÃ¡t cá»§a riÃªng mÃ¬nh. CÃ³ biáº¿t láº¯ng nghe nhau má»›i hiá»ƒu Ä‘Æ°á»£c tiáº¿ng hÃ¡t cá»§a nhau, cÃ¡c chÃ¡u áº¡.</p>
                <p class="text-right italic font-bold text-sm">(Theo Quá»³nh Anh)</p>
            </div>
        </div>

        <div class="flex-1 bg-gray-50 overflow-y-auto p-4 scroll-smooth" id="bottom-pane">
            
            <div id="quiz-part" class="space-y-4 pb-8">
                <h3 class="font-black text-sm text-red-600 bg-red-100 px-3 py-2 rounded flex justify-between items-center sticky top-0 z-20 shadow-sm border border-red-200">
                    <span>ğŸ“ CÃ‚U Há»I & BÃ€I LÃ€M</span>
                </h3>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau1">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 1 (0.5Ä‘): Äiá»u gÃ¬ Ä‘Ã£ khiáº¿n bÃ´ng hoa láº¡ cáº¥t tiáº¿ng hÃ¡t vÃ o buá»•i sÃ¡ng sá»›m?</p>
                    <div class="space-y-2 text-sm" id="group_cau1">
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau1" value="A"> <span>A. VÃ¬ nhá»¯ng cÃ¡nh bÆ°á»›m dáº­p dá»n quanh nÃ³.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau1" value="B"> <span>B. VÃ¬ máº·t trá»i má»‰m cÆ°á»i vá»›i hoa.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau1" value="C"> <span>C. VÃ¬ nhá»¯ng háº¡t sÆ°Æ¡ng long lanh Ä‘áº­u trÃªn cÃ¡nh hoa.</span></label>
                    </div>
                    <div class="explanation" id="giai_cau1">ğŸ’¡ <b>Giáº£i thÃ­ch:</b> Trong bÃ i cÃ³ cÃ¢u: "Máº·t Trá»i má»‰m cÆ°á»i vá»›i hoa. Tháº¿ lÃ  bÃ´ng hoa cáº¥t tiáº¿ng hÃ¡t." <br>âœ… <b>ÄÃ¡p Ã¡n: B</b></div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau2">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 2 (0.5Ä‘): Theo giáº£i thÃ­ch cá»§a giÃ³, Ã¢m thanh â€œlao xaoâ€ Ä‘Æ°á»£c táº¡o ra tá»« Ä‘Ã¢u?</p>
                    <div class="space-y-2 text-sm" id="group_cau2">
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau2" value="A"> <span>A. Tá»« nhá»¯ng háº¡t sÆ°Æ¡ng ngÃ¢n nga.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau2" value="B"> <span>B. Tá»« tiáº¿ng hÃ¡t cá»§a bÃ´ng hoa.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau2" value="C"> <span>C. Tá»« viá»‡c giÃ³ lÃ m nhá»¯ng cÃ¡nh hoa rung rinh, Ä‘ong Ä‘Æ°a.</span></label>
                    </div>
                    <div class="explanation" id="giai_cau2">ğŸ’¡ <b>Giáº£i thÃ­ch:</b> GiÃ³ nÃ³i: "TÃ´i Ä‘Ã£ lÃ m nhá»¯ng cÃ¡nh hoa cá»§a báº¡n Ä‘ung Ä‘Æ°a, táº¡o thÃ nh tiáº¿ng lao xao..." <br>âœ… <b>ÄÃ¡p Ã¡n: C</b></div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau3">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 3 (0.5Ä‘): Táº¡i sao ba nhÃ¢n váº­t trong cÃ¢u chuyá»‡n láº¡i quyáº¿t Ä‘á»‹nh Ä‘i há»i bÃ¡c gÃ¡c rá»«ng?</p>
                    <div class="space-y-2 text-sm" id="group_cau3">
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau3" value="A"> <span>A. VÃ¬ há» tranh cÃ£i mÃ£i mÃ  cháº³ng biáº¿t ai Ä‘Ãºng, ai sai.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau3" value="B"> <span>B. VÃ¬ bÃ¡c gÃ¡c rá»«ng muá»‘n há» giáº£i thÃ­ch.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau3" value="C"> <span>C. VÃ¬ há» muá»‘n hÃ¡t cho bÃ¡c gÃ¡c rá»«ng nghe.</span></label>
                    </div>
                    <div class="explanation" id="giai_cau3">ğŸ’¡ <b>Giáº£i thÃ­ch:</b> BÃ i Ä‘á»c viáº¿t: "Tranh cÃ£i mÃ£i, cháº³ng ai chá»‹u ai. Hoa, giÃ³ vÃ  sÆ°Æ¡ng quyáº¿t Ä‘á»‹nh há»i bÃ¡c gÃ¡c rá»«ng." <br>âœ… <b>ÄÃ¡p Ã¡n: A</b></div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau4">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 4 (0.5Ä‘): Theo bÃ¡c gÃ¡c rá»«ng, má»—i loÃ i trong thiÃªn nhiÃªn cÃ³ Ä‘áº·c Ä‘iá»ƒm gÃ¬ chung vÃ o buá»•i sá»›m mai?</p>
                    <input type="text" id="cau4_tuluan" class="w-full border-2 border-green-50 p-2 rounded text-sm" placeholder="Nháº­p cÃ¢u tráº£ lá»i...">
                    <div class="explanation" id="giai_cau4">ğŸ’¡ <b>Gá»£i Ã½:</b> MuÃ´n loÃ i Ä‘á»u hÃ¢n hoan hÃ¡t ca khi Máº·t Trá»i sÆ°á»Ÿi áº¥m.</div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau5">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 5 (0.5Ä‘): Äiá»u quan trá»ng nháº¥t Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c â€œtiáº¿ng hÃ¡tâ€ cá»§a nhau lÃ  gÃ¬?</p>
                    <div class="space-y-2 text-sm" id="group_cau5">
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau5" value="A"> <span>A. Pháº£i hÃ¡t tháº­t to Ä‘á»ƒ táº¥t cáº£ má»i ngÆ°á»i Ä‘á»u nghe.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau5" value="B"> <span>B. Pháº£i tranh luáº­n vá»›i nhau.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau5" value="C"> <span>C. Pháº£i biáº¿t láº¯ng nghe nhau.</span></label>
                    </div>
                    <div class="explanation" id="giai_cau5">ğŸ’¡ <b>Giáº£i thÃ­ch:</b> BÃ¡c gÃ¡c rá»«ng nÃ³i: "CÃ³ biáº¿t láº¯ng nghe nhau má»›i hiá»ƒu Ä‘Æ°á»£c tiáº¿ng hÃ¡t cá»§a nhau". <br>âœ… <b>ÄÃ¡p Ã¡n: C</b></div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau6">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 6 (0.5Ä‘): CÃ¢u chuyá»‡n giÃºp chÃºng ta hiá»ƒu Ä‘Æ°á»£c Ä‘iá»u gÃ¬?</p>
                    <div class="space-y-2 text-sm" id="group_cau6">
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau6" value="A"> <span>A. GiÃ³ vÃ  sÆ°Æ¡ng luÃ´n quan trá»ng hÆ¡n hoa.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau6" value="B"> <span>B. Cáº§n biáº¿t láº¯ng nghe, tháº¥u hiá»ƒu vÃ  tÃ´n trá»ng giÃ¡ trá»‹ riÃªng cá»§a ngÆ°á»i khÃ¡c.</span></label>
                        <label class="flex items-start gap-2 p-1 rounded cursor-pointer hover:bg-gray-50"><input type="radio" name="cau6" value="C"> <span>C. Cáº§n há»c nhá» ngÆ°á»i lá»›n giáº£i quyáº¿t má»i cuá»™c tranh cÃ£i.</span></label>
                    </div>
                    <div class="explanation" id="giai_cau6">ğŸ’¡ <b>Giáº£i thÃ­ch:</b> BÃ i há»c rÃºt ra lÃ  má»—i ngÆ°á»i cÃ³ giÃ¡ trá»‹ riÃªng, cáº§n láº¯ng nghe Ä‘á»ƒ tháº¥u hiá»ƒu nhau. <br>âœ… <b>ÄÃ¡p Ã¡n: B</b></div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau7">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 7 (1.5Ä‘): HÃ£y tÃ¬m vÃ  viáº¿t láº¡i 5 tÃ­nh tá»« cÃ³ trong bÃ i Ä‘á»c?</p>
                    <input type="text" id="cau7_tuluan" class="w-full border-2 border-green-50 p-2 rounded text-sm" placeholder="...">
                    <div class="explanation" id="giai_cau7">ğŸ’¡ <b>Gá»£i Ã½:</b> láº¡, má»‹n, thÆ¡m ngÃ¡t, tháº¥p thoÃ¡ng, dáº­p dá»n, ngáº¡c nhiÃªn, long lanh, thÃ¡nh thÃ³t, Ã´n tá»“n, hÃ¢n hoan...</div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau8">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 8 (1.0Ä‘): HÃ£y viáº¿t láº¡i tÃªn cÃ¡c cÆ¡ quan, tá»• chá»©c sau Ä‘Ã¢y cho Ä‘Ãºng:<br><span class="font-normal italic">trÆ°á»ng tiá»ƒu há»c chÃ¢u lá»™c, sá»Ÿ y táº¿ thanh hoÃ¡, kinh thÃ nh thÄƒng long, sÃ´ng mÃ£.</span></p>
                    <input type="text" id="cau8_tuluan" class="w-full border-2 border-green-50 p-2 rounded text-sm" placeholder="Viáº¿t láº¡i cho Ä‘Ãºng...">
                    <div class="explanation" id="giai_cau8">ğŸ’¡ <b>ÄÃ¡p Ã¡n chuáº©n:</b> TrÆ°á»ng Tiá»ƒu há»c ChÃ¢u Lá»™c, Sá»Ÿ Y táº¿ Thanh HoÃ¡, Kinh thÃ nh ThÄƒng Long, SÃ´ng MÃ£.</div>
                </div>

                <div class="bg-white p-3 rounded-lg shadow-sm border border-gray-200" id="box_cau9">
                    <p class="font-bold text-gray-800 text-sm mb-2">CÃ¢u 9 (1.5Ä‘): Viá»‡c sá»­ dá»¥ng biá»‡n phÃ¡p nhÃ¢n hoÃ¡ trong bÃ i vÄƒn trÃªn cÃ³ tÃ¡c dá»¥ng gÃ¬?</p>
                    <input type="text" id="cau9_tuluan" class="w-full border-2 border-green-50 p-2 rounded text-sm" placeholder="...">
                    <div class="explanation" id="giai_cau9">ğŸ’¡ <b>Gá»£i Ã½:</b> LÃ m cho cÃ¡c sá»± váº­t (hoa, giÃ³, sÆ°Æ¡ng) trá»Ÿ nÃªn sinh Ä‘á»™ng, cÃ³ suy nghÄ© vÃ  tÃ¬nh cáº£m giá»‘ng nhÆ° con ngÆ°á»i.</div>
                </div>

                <div class="mt-4" id="submit-area">
                    <button onclick="nopPhan1()" class="w-full bg-green-600 hover:bg-green-700 text-white font-black py-4 rounded-xl text-lg shadow-xl border-b-4 border-green-800">
                        Ná»˜P BÃ€I PHáº¦N 1
                    </button>
                    <p class="text-center text-gray-500 text-xs mt-2 italic pb-4">Ná»™p Ä‘á»ƒ xem káº¿t quáº£ vÃ  Ä‘á» pháº§n tiáº¿p theo</p>
                </div>
            </div>

            <div id="result-screen" class="hidden pb-10">
                <div class="bg-green-100 border-l-4 border-green-500 p-3 mb-6 rounded shadow">
                    <h2 class="font-bold text-green-800">ğŸ‰ Ná»˜P BÃ€I THÃ€NH CÃ”NG!</h2>
                    <p class="text-green-700 text-sm">Xem lá»i giáº£i bÃªn trÃªn vÃ  lÃ m tiáº¿p pháº§n dÆ°á»›i nhÃ©.</p>
                </div>

                <div class="bg-white p-4 rounded-xl shadow-xl border-t-8 border-indigo-600 mb-8">
                    <h3 class="font-black text-indigo-800 mb-4 uppercase border-b pb-2 text-center">ğŸ‘‡ BÃ€I Táº¬P Vá»€ NHÃ€ (Gá»¬I ZALO) ğŸ‘‡</h3>
                    
                    <div class="mb-4 bg-indigo-50 p-3 rounded-lg">
                        <p class="font-bold text-gray-700">ğŸ¤ PHáº¦N 2: Äá»ŒC THÃ€NH TIáº¾NG (3Ä‘)</p>
                        <p class="text-sm text-gray-600 mb-1">Con hÃ£y quay video Ä‘á»c bÃ i:</p>
                        <p id="baiDocRandom" class="text-xl font-black text-red-600 uppercase my-2">...</p>
                        <p class="text-xs italic text-gray-500">(BÃ i Ä‘á»c ngáº«u nhiÃªn tá»« sÃ¡ch Káº¿t ná»‘i tri thá»©c 4 - Táº­p 1)</p>
                    </div>

                    <div class="mb-4 bg-yellow-50 p-3 rounded-lg">
                        <p class="font-bold text-gray-700">âœï¸ PHáº¦N 3: Táº¬P LÃ€M VÄ‚N (10Ä‘)</p>
                        <p class="text-red-700 font-bold text-sm mt-1">Äá» bÃ i: MiÃªu táº£ má»™t con váº­t mÃ  em yÃªu thÃ­ch.</p>
                    </div>

                    <div class="text-center">
                        <a href="../index.html" class="block w-full bg-gray-600 text-white font-bold py-3 rounded-full shadow-lg border-b-4 border-gray-800">â¬…ï¸ QUAY Vá»€ TRANG CHá»¦</a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA77lLi_JCLIdR535KEfg3S0_Ge2EorPMo", 
            authDomain: "baikiemtracuoiki.firebaseapp.com",
            projectId: "baikiemtracuoiki",
            storageBucket: "baikiemtracuoiki.appspot.com",
            messagingSenderId: "953819948776",
            appId: "1:953819948776:web:15848507d350f37c35e5d3"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- DANH SÃCH BÃ€I Äá»ŒC (Káº¿t ná»‘i tri thá»©c) ---
        const LIST_BAI_DOC = [
            "Äiá»u kÃ¬ diá»‡u", 
            "Thi nháº¡c", 
            "Váº½ mÃ u", 
            "Thanh Ã¢m cá»§a nÃºi", 
            "Báº§u trá»i trong quáº£ trá»©ng", 
            "Tiáº¿ng nÃ³i cá»§a cá» cÃ¢y",
            "CÃ¡nh chim nhá»"
        ];
        
        // --- Cáº¤U HÃŒNH ÄÃP ÃN ---
        const KEY = {
            cau1: "B", cau2: "C", cau3: "A", cau5: "C", cau6: "B"
        };

        let baiDocDuocChon = "";

        window.onload = function() {
            // Random bÃ i Ä‘á»c
            baiDocDuocChon = LIST_BAI_DOC[Math.floor(Math.random() * LIST_BAI_DOC.length)];
            document.getElementById('baiDocRandom').innerText = baiDocDuocChon;
            
            // Äá»“ng há»“ 35 phÃºt
            let time = 35 * 60;
            const display = document.getElementById('dongHo');
            const timer = setInterval(() => {
                let m = Math.floor(time / 60); let s = time % 60;
                display.innerText = `${m<10?'0'+m:m}:${s<10?'0'+s:s}`;
                time--;
                if(time < 0) { clearInterval(timer); nopPhan1(); }
            }, 1000);
        };

        window.nopPhan1 = async function() {
            const hoTen = document.getElementById('hoTen').value.trim();
            const lop = document.getElementById('lop').value.trim();
            if (!hoTen || !lop) { alert("Con chÆ°a Ä‘iá»n TÃªn/Lá»›p!"); return; }

            const btn = document.querySelector('#submit-area button');
            btn.innerText = "Äang cháº¥m..."; btn.disabled = true;

            let diem = 0;
            // Cháº¥m Ä‘iá»ƒm & Hiá»‡n giáº£i thÃ­ch
            for (const [id, dapAn] of Object.entries(KEY)) {
                const box = document.getElementById(`box_${id}`);
                const luaChon = document.querySelector(`input[name="${id}"]:checked`);
                const inputs = document.querySelectorAll(`input[name="${id}"]`);
                
                if(document.getElementById(`giai_${id}`)) document.getElementById(`giai_${id}`).style.display = 'block';
                inputs.forEach(i => i.disabled = true);

                if (luaChon && luaChon.value === dapAn) {
                    diem += 0.5; // Äiá»ƒm má»—i cÃ¢u Tráº¯c nghiá»‡m
                    luaChon.parentElement.classList.add('correct-answer');
                } else {
                    if(luaChon) luaChon.parentElement.classList.add('wrong-answer');
                }
            }

            // Hiá»‡n giáº£i thÃ­ch cÃ¢u tá»± luáº­n
            ['cau4', 'cau7', 'cau8', 'cau9'].forEach(id => {
                const el = document.getElementById(`${id}_tuluan`);
                const giai = document.getElementById(`giai_${id}`);
                if(el && giai) {
                    el.disabled = true;
                    giai.style.display = 'block';
                }
            });

            // Tá»•ng há»£p ná»™i dung tá»± luáº­n
            const tuLuan = `
                [CÃ¢u 4] ${document.getElementById('cau4_tuluan').value}
                [CÃ¢u 7] ${document.getElementById('cau7_tuluan').value}
                [CÃ¢u 8] ${document.getElementById('cau8_tuluan').value}
                [CÃ¢u 9] ${document.getElementById('cau9_tuluan').value}
            `;

            // Gá»­i dá»¯ liá»‡u
            try {
                await addDoc(collection(db, "Baikiemtracuoiki"), {
                    ho_ten: hoTen, lop: lop, mon_hoc: "Tiáº¿ng Viá»‡t", ma_de: "Äá» 02",
                    diem_trac_nghiem: diem, diem_tu_luan: 0, bai_tu_luan: tuLuan,
                    bai_doc_random: baiDocDuocChon,
                    thoi_gian_nop: new Date().toISOString()
                });

                document.getElementById('submit-area').style.display = 'none';
                document.getElementById('result-screen').classList.remove('hidden');
                document.getElementById('bottom-pane').scrollTop = document.getElementById('bottom-pane').scrollHeight;
                alert(`ÄÃ£ ná»™p bÃ i! Äiá»ƒm tráº¯c nghiá»‡m: ${diem} Ä‘iá»ƒm.`);
            } catch (e) {
                alert("Lá»—i: " + e.message);
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
